2025-01-12 15:52:45.679 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 15:52:47.727 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.728 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.728 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.728 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.728 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.728 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.729 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:47.730 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:52:49.407 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 15:52:49.408 +03:00 [INF] Hosting environment: Development
2025-01-12 15:52:49.408 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 15:52:49.540 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/swagger - null null
2025-01-12 15:52:49.692 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 15:52:49.996 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/swagger/index.html - null null
2025-01-12 15:52:50.027 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 15:52:50.038 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/swagger - 301 null null 514.7637ms
2025-01-12 15:52:50.288 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/swagger/index.html - 200 null text/html;charset=utf-8 292.0896ms
2025-01-12 15:52:50.317 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/swagger/swagger-ui-bundle.js - null null
2025-01-12 15:52:50.330 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 15:52:50.334 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/swagger/swagger-ui.css - null null
2025-01-12 15:52:50.345 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/swagger/swagger-ui-standalone-preset.js - null null
2025-01-12 15:52:50.349 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/_vs/browserLink - null null
2025-01-12 15:52:50.359 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 25.5842ms
2025-01-12 15:52:50.379 +03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-01-12 15:52:50.381 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-01-12 15:52:50.383 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/swagger/swagger-ui.css - 200 143943 text/css 49.731ms
2025-01-12 15:52:50.399 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 55.959ms
2025-01-12 15:52:50.399 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-01-12 15:52:50.445 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 126.3743ms
2025-01-12 15:52:50.463 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/_vs/browserLink - 200 null text/javascript; charset=UTF-8 114.1274ms
2025-01-12 15:52:50.832 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/swagger/v1/swagger.json - null null
2025-01-12 15:52:50.885 +03:00 [INF] Request starting HTTP/2 GET https://localhost:44383/swagger/favicon-32x32.png - null null
2025-01-12 15:52:50.887 +03:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-01-12 15:52:50.888 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/swagger/favicon-32x32.png - 200 628 image/png 2.5536ms
2025-01-12 15:52:51.123 +03:00 [INF] Request finished HTTP/2 GET https://localhost:44383/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 291.3075ms
2025-01-12 15:53:39.441 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 15:53:40.698 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.701 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.703 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.704 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.706 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.707 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.709 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.710 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.712 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.714 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.715 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.717 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.718 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.719 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.721 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.722 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.724 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:40.726 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 15:53:42.011 +03:00 [INF] Now listening on: https://localhost:7195
2025-01-12 15:53:42.012 +03:00 [INF] Now listening on: http://localhost:5285
2025-01-12 15:53:42.017 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 15:53:42.019 +03:00 [INF] Hosting environment: Development
2025-01-12 15:53:42.020 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 15:53:42.036 +03:00 [INF] Executed DbCommand (91ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 15:53:42.221 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 15:53:42.752 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/index.html - null null
2025-01-12 15:53:43.287 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/index.html - 200 null text/html;charset=utf-8 544.8172ms
2025-01-12 15:53:43.302 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 15:53:43.321 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 22.9235ms
2025-01-12 15:53:43.335 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_vs/browserLink - null null
2025-01-12 15:53:43.425 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_vs/browserLink - 200 null text/javascript; charset=UTF-8 90.6949ms
2025-01-12 15:53:43.485 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - null null
2025-01-12 15:53:43.867 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 382.894ms
2025-01-12 15:53:57.002 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7195/api/v1/inventories - application/json 440
2025-01-12 15:53:57.362 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject)'
2025-01-12 15:53:57.416 +03:00 [INF] Route matched with {action = "GetAllInventories", controller = "Inventories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllInventories() on controller TagerProject.Controllers.InventoriesController (TagerProject).
2025-01-12 15:53:57.900 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0
2025-01-12 15:53:58.119 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[TagerProject.Models.Dtos.Inventory.InventoryResponse, TagerProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-12 15:53:58.241 +03:00 [INF] Executed action TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject) in 808.495ms
2025-01-12 15:53:58.245 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject)'
2025-01-12 15:53:58.259 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7195/api/v1/inventories - 200 null application/json; charset=utf-8 1257.781ms
2025-01-12 16:59:35.107 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 16:59:36.627 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.630 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.632 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.633 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.635 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.636 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.637 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.639 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.641 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.643 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.645 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.646 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.648 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.650 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.652 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.654 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.656 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:36.658 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 16:59:38.069 +03:00 [INF] Now listening on: https://localhost:7195
2025-01-12 16:59:38.070 +03:00 [INF] Now listening on: http://localhost:5285
2025-01-12 16:59:38.076 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 16:59:38.078 +03:00 [INF] Hosting environment: Development
2025-01-12 16:59:38.079 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 16:59:38.082 +03:00 [INF] Executed DbCommand (160ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 16:59:38.414 +03:00 [INF] Executed DbCommand (178ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 16:59:38.893 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/index.html - null null
2025-01-12 16:59:39.410 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/index.html - 200 null text/html;charset=utf-8 538.571ms
2025-01-12 16:59:39.463 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 16:59:39.479 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_vs/browserLink - null null
2025-01-12 16:59:39.493 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 35.9196ms
2025-01-12 16:59:39.560 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_vs/browserLink - 200 null text/javascript; charset=UTF-8 79.4807ms
2025-01-12 16:59:39.631 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - null null
2025-01-12 16:59:39.974 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 343.2346ms
2025-01-12 17:00:38.538 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:00:38.552 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:01:38.689 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:01:38.702 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:02:38.734 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:02:38.744 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:03:38.771 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:03:38.781 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:03:53.928 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:03:54.223 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/12/2025 12:49:59 PM', Current time (UTC): '1/12/2025 2:03:54 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-01-12 17:03:54.273 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/12/2025 12:49:59 PM', Current time (UTC): '1/12/2025 2:03:54 PM'.
2025-01-12 17:03:54.290 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-01-12 17:03:54.299 +03:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-12 17:03:54.344 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 401 null application/json 415.9039ms
2025-01-12 17:03:59.793 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/auth/login - application/json 65
2025-01-12 17:03:59.809 +03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/1/2025 2:20:38 PM', Current time (UTC): '1/12/2025 2:03:59 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-01-12 17:03:59.813 +03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '1/1/2025 2:20:38 PM', Current time (UTC): '1/12/2025 2:03:59 PM'.
2025-01-12 17:03:59.820 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.AuthController.Login (TagerProject)'
2025-01-12 17:03:59.909 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(TagerProject.Models.Dtos.LoginDto) on controller TagerProject.Controllers.AuthController (TagerProject).
2025-01-12 17:04:00.169 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__loginDto_Email_0='?' (Size = 40)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[Email] = @__loginDto_Email_0
2025-01-12 17:04:00.573 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`2[[TagerProject.Models.Entities.Owner, TagerProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-01-12 17:04:00.644 +03:00 [INF] Executed action TagerProject.Controllers.AuthController.Login (TagerProject) in 693.0918ms
2025-01-12 17:04:00.657 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.AuthController.Login (TagerProject)'
2025-01-12 17:04:00.675 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/auth/login - 200 null application/json; charset=utf-8 882.3067ms
2025-01-12 17:04:18.315 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:04:18.342 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:04:18.358 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:04:18.769 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:04:18.941 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:04:19.507 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime2), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (DbType = Boolean), @p11='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (Size = 4000), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-01-12 17:04:19.646 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([OrderId], [ProductId], [Quantity], [UnitPrice])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-01-12 17:04:19.699 +03:00 [INF] Executing OkObjectResult, writing value of type 'TagerProject.Models.Dtos.Order.OrderResponse'.
2025-01-12 17:04:19.727 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 1366.7117ms
2025-01-12 17:04:19.731 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:04:19.734 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 1419.6239ms
2025-01-12 17:04:38.793 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:04:38.805 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:05:18.948 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7195/api/v1/inventories - application/json 195
2025-01-12 17:05:18.956 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject)'
2025-01-12 17:05:18.965 +03:00 [INF] Route matched with {action = "GetAllInventories", controller = "Inventories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllInventories() on controller TagerProject.Controllers.InventoriesController (TagerProject).
2025-01-12 17:05:19.006 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0
2025-01-12 17:05:19.026 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[TagerProject.Models.Dtos.Inventory.InventoryResponse, TagerProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-12 17:05:19.047 +03:00 [INF] Executed action TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject) in 79.179ms
2025-01-12 17:05:19.048 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject)'
2025-01-12 17:05:19.050 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7195/api/v1/inventories - 200 null application/json; charset=utf-8 103.8051ms
2025-01-12 17:05:38.833 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:05:38.843 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:05:52.487 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:05:52.495 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:05:52.497 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:05:52.523 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:05:52.538 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:05:52.553 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:05:52.721 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 220.8916ms
2025-01-12 17:05:52.725 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:05:52.855 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:05:52.910 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 423.5913ms
2025-01-12 17:06:08.891 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:06:08.896 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:06:08.897 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:06:08.913 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:06:08.928 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:06:08.929 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:06:09.049 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 150.1836ms
2025-01-12 17:06:09.053 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:06:09.153 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:06:09.176 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 284.2ms
2025-01-12 17:06:10.991 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:06:10.994 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:06:10.996 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:06:11.012 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:06:11.022 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:06:11.022 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:06:11.099 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 101.0922ms
2025-01-12 17:06:11.101 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:06:11.184 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:06:11.196 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 204.9153ms
2025-01-12 17:06:16.937 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:06:16.941 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject)'
2025-01-12 17:06:16.950 +03:00 [INF] Route matched with {action = "GetAllOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOrders() on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:06:17.048 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CouponCode], [o].[CustomerId], [o].[DateTime], [o].[DiscountAmount], [o].[DiscountId], [o].[FinalAmount], [o].[Guid], [o].[MembershipNumber], [o].[Paid], [o].[PaidAmount], [o].[PaymentMethodId], [o].[PaymentTypeId], [o].[Status], [o].[TaxAmount], [o].[TotalAmount], [o0].[Id], [o0].[OrderId], [o0].[ProductId], [o0].[Quantity], [o0].[UnitPrice]
FROM [Orders] AS [o]
LEFT JOIN [OrderItems] AS [o0] ON [o].[Id] = [o0].[OrderId]
WHERE [o].[MembershipNumber] = @__membershipNumber_0
ORDER BY [o].[Id]
2025-01-12 17:06:17.090 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[TagerProject.Models.Dtos.Order.OrderResponse, TagerProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-12 17:06:17.093 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject) in 139.6334ms
2025-01-12 17:06:17.095 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject)'
2025-01-12 17:06:17.097 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 160.3489ms
2025-01-12 17:06:30.898 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:06:30.902 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:06:30.903 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:06:30.940 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:06:30.947 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:06:30.951 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:06:31.058 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 147.6252ms
2025-01-12 17:06:31.060 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:06:31.146 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:06:31.163 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 264.3694ms
2025-01-12 17:06:49.649 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 17:06:51.003 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.006 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.008 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.009 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.011 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.012 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.013 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.014 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.016 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.018 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.020 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.022 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.023 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.025 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.027 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.028 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.030 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:51.031 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:06:52.398 +03:00 [INF] Now listening on: https://localhost:7195
2025-01-12 17:06:52.399 +03:00 [INF] Now listening on: http://localhost:5285
2025-01-12 17:06:52.406 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 17:06:52.408 +03:00 [INF] Hosting environment: Development
2025-01-12 17:06:52.410 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 17:06:52.447 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:06:52.597 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:06:53.118 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/index.html - null null
2025-01-12 17:06:53.482 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 17:06:53.483 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/index.html - 200 null text/html;charset=utf-8 375.3457ms
2025-01-12 17:06:53.506 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 23.7543ms
2025-01-12 17:06:53.523 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_vs/browserLink - null null
2025-01-12 17:06:53.610 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_vs/browserLink - 200 null text/javascript; charset=UTF-8 86.8156ms
2025-01-12 17:06:53.680 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - null null
2025-01-12 17:06:53.941 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 260.9135ms
2025-01-12 17:07:01.801 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:07:02.120 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:07:02.195 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:07:02.869 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:07:03.203 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:07:03.628 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime2), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (DbType = Boolean), @p11='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (Size = 4000), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-01-12 17:07:03.771 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([OrderId], [ProductId], [Quantity], [UnitPrice])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-01-12 17:07:03.820 +03:00 [INF] Executing OkObjectResult, writing value of type 'TagerProject.Models.Dtos.Order.OrderResponse'.
2025-01-12 17:07:03.886 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 1673.1106ms
2025-01-12 17:07:03.892 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:07:03.904 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 2103.9633ms
2025-01-12 17:07:24.737 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7195/api/v1/inventories - application/json 195
2025-01-12 17:07:24.753 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject)'
2025-01-12 17:07:24.767 +03:00 [INF] Route matched with {action = "GetAllInventories", controller = "Inventories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllInventories() on controller TagerProject.Controllers.InventoriesController (TagerProject).
2025-01-12 17:07:24.906 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0
2025-01-12 17:07:24.927 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[TagerProject.Models.Dtos.Inventory.InventoryResponse, TagerProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-12 17:07:24.947 +03:00 [INF] Executed action TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject) in 177.4154ms
2025-01-12 17:07:24.949 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.InventoriesController.GetAllInventories (TagerProject)'
2025-01-12 17:07:24.951 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7195/api/v1/inventories - 200 null application/json; charset=utf-8 214.3567ms
2025-01-12 17:07:52.678 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:07:52.690 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:11:03.249 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 17:11:04.364 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.366 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.368 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.369 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.370 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.371 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.373 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.374 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.376 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.378 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.381 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.382 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.384 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.386 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.387 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.389 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.391 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:04.392 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:11:05.632 +03:00 [INF] Now listening on: https://localhost:7195
2025-01-12 17:11:05.633 +03:00 [INF] Now listening on: http://localhost:5285
2025-01-12 17:11:05.639 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 17:11:05.642 +03:00 [INF] Hosting environment: Development
2025-01-12 17:11:05.643 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 17:11:05.676 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:11:05.831 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:11:06.460 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/index.html - null null
2025-01-12 17:11:06.897 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 17:11:06.900 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/index.html - 200 null text/html;charset=utf-8 456.6718ms
2025-01-12 17:11:06.909 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 12.7012ms
2025-01-12 17:11:06.918 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_vs/browserLink - null null
2025-01-12 17:11:06.990 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_vs/browserLink - 200 null text/javascript; charset=UTF-8 71.9399ms
2025-01-12 17:11:07.050 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - null null
2025-01-12 17:11:07.385 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 334.8865ms
2025-01-12 17:11:27.188 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:11:28.565 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:11:28.642 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:11:29.315 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:11:29.781 +03:00 [INF] Executed DbCommand (166ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:11:29.994 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:11:30.168 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 1508.6849ms
2025-01-12 17:11:30.176 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:11:30.406 +03:00 [INF] Executed DbCommand (249ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Guid), @p7='?' (Size = 4000), @p8='?' (DbType = Boolean), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Size = 4000), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-01-12 17:11:30.414 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:11:30.510 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 3322.2638ms
2025-01-12 17:11:36.660 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:11:37.093 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:11:37.109 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:11:38.015 +03:00 [INF] Executed DbCommand (667ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:11:38.077 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:11:38.288 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 1139.6963ms
2025-01-12 17:11:38.289 +03:00 [INF] Executed DbCommand (240ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:11:38.306 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:11:38.462 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:11:38.485 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 1825.3985ms
2025-01-12 17:12:13.505 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 17:12:14.898 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.901 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.903 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.905 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.906 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.908 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.909 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.911 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.914 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.915 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.917 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.920 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.922 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.924 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.926 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.928 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.930 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:14.932 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:16.340 +03:00 [INF] Now listening on: https://localhost:7195
2025-01-12 17:12:16.342 +03:00 [INF] Now listening on: http://localhost:5285
2025-01-12 17:12:16.353 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 17:12:16.357 +03:00 [INF] Hosting environment: Development
2025-01-12 17:12:16.370 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 17:12:16.403 +03:00 [INF] Executed DbCommand (142ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:12:16.661 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:12:17.017 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/index.html - null null
2025-01-12 17:12:17.545 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/index.html - 200 null text/html;charset=utf-8 545.7766ms
2025-01-12 17:12:17.563 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 17:12:17.590 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 27.179ms
2025-01-12 17:12:17.597 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_vs/browserLink - null null
2025-01-12 17:12:17.695 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_vs/browserLink - 200 null text/javascript; charset=UTF-8 98.8313ms
2025-01-12 17:12:17.777 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - null null
2025-01-12 17:12:18.125 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 347.8844ms
2025-01-12 17:12:28.601 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:12:28.913 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:12:28.964 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:12:29.472 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:12:29.724 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:12:30.032 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:12:30.321 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 1343.5187ms
2025-01-12 17:12:30.333 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:12:30.500 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:12:30.577 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 1976.1324ms
2025-01-12 17:12:33.686 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:12:33.701 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:12:33.705 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:12:33.857 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:12:33.873 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:12:33.881 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:12:34.033 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 321.9868ms
2025-01-12 17:12:34.036 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:12:34.139 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:12:34.183 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Int32), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p18='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0, [TotalPurchasePrice] = @p1, [TotalSalesPrice] = @p2
OUTPUT 1
WHERE [Id] = @p3;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-01-12 17:12:34.190 +03:00 [ERR] Connection id "0HN9J2CF6TMK1", Request id "0HN9J2CF6TMK1:00000002": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ResetStateAsync(Boolean disposeDbConnection)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|26_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.EntityFrameworkCore.DbContext.DisposeAsync()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|26_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.<FireOnCompleted>g__ProcessEvents|242_0(HttpProtocol protocol, Stack`1 events)
2025-01-12 17:12:34.211 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 525.1711ms
2025-01-12 17:12:35.912 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:12:35.927 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:12:35.929 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:12:35.950 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:12:35.959 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:12:35.963 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:12:36.053 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 122.4367ms
2025-01-12 17:12:36.056 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:12:36.155 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Int32), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p18='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0, [TotalPurchasePrice] = @p1, [TotalSalesPrice] = @p2
OUTPUT 1
WHERE [Id] = @p3;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-01-12 17:12:36.157 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:12:36.178 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 265.315ms
2025-01-12 17:12:46.985 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 17:12:48.352 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.356 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.358 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.360 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.362 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.364 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.366 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.368 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.370 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.371 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.373 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.374 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.377 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.379 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.381 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.383 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.384 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:48.386 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:12:49.730 +03:00 [INF] Now listening on: https://localhost:7195
2025-01-12 17:12:49.731 +03:00 [INF] Now listening on: http://localhost:5285
2025-01-12 17:12:49.749 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 17:12:49.752 +03:00 [INF] Hosting environment: Development
2025-01-12 17:12:49.753 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 17:12:49.798 +03:00 [INF] Executed DbCommand (96ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:12:49.965 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:12:50.504 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/index.html - null null
2025-01-12 17:12:50.901 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/index.html - 200 null text/html;charset=utf-8 410.5312ms
2025-01-12 17:12:50.913 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 17:12:50.928 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 15.497ms
2025-01-12 17:12:50.945 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_vs/browserLink - null null
2025-01-12 17:12:51.023 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_vs/browserLink - 200 null text/javascript; charset=UTF-8 78.6509ms
2025-01-12 17:12:51.095 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - null null
2025-01-12 17:12:51.452 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 356.0781ms
2025-01-12 17:12:57.451 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:12:57.761 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:12:57.818 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:12:58.384 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:12:58.692 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:12:58.978 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:12:59.110 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 1282.2289ms
2025-01-12 17:12:59.115 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:12:59.228 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:12:59.281 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Int32), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p18='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0, [TotalPurchasePrice] = @p1, [TotalSalesPrice] = @p2
OUTPUT 1
WHERE [Id] = @p3;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-01-12 17:12:59.284 +03:00 [ERR] Connection id "0HN9J2CP6IP9H", Request id "0HN9J2CP6IP9H:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ResetStateAsync(Boolean disposeDbConnection)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|26_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.EntityFrameworkCore.DbContext.DisposeAsync()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|26_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.<FireOnCompleted>g__ProcessEvents|242_0(HttpProtocol protocol, Stack`1 events)
2025-01-12 17:12:59.302 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 1851.4824ms
2025-01-12 17:13:03.100 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:13:03.120 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject)'
2025-01-12 17:13:03.130 +03:00 [INF] Route matched with {action = "GetAllOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOrders() on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:13:03.356 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CouponCode], [o].[CustomerId], [o].[DateTime], [o].[DiscountAmount], [o].[DiscountId], [o].[FinalAmount], [o].[Guid], [o].[MembershipNumber], [o].[Paid], [o].[PaidAmount], [o].[PaymentMethodId], [o].[PaymentTypeId], [o].[Status], [o].[TaxAmount], [o].[TotalAmount], [o0].[Id], [o0].[OrderId], [o0].[ProductId], [o0].[Quantity], [o0].[UnitPrice]
FROM [Orders] AS [o]
LEFT JOIN [OrderItems] AS [o0] ON [o].[Id] = [o0].[OrderId]
WHERE [o].[MembershipNumber] = @__membershipNumber_0
ORDER BY [o].[Id]
2025-01-12 17:13:03.464 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[TagerProject.Models.Dtos.Order.OrderResponse, TagerProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-12 17:13:03.512 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject) in 380.3734ms
2025-01-12 17:13:03.521 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject)'
2025-01-12 17:13:03.526 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 426.1378ms
2025-01-12 17:13:09.318 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:13:09.329 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:13:09.334 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:13:09.363 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:13:09.379 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:13:09.379 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:13:09.475 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 138.9323ms
2025-01-12 17:13:09.482 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:13:09.583 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:13:09.600 +03:00 [ERR] Connection id "0HN9J2CP6IP9H", Request id "0HN9J2CP6IP9H:00000003": An unhandled exception was thrown by the application.
System.InvalidOperationException: The connection does not support MultipleActiveResultSets.
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Rollback()
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose(Boolean disposing)
   at Microsoft.Data.SqlClient.SqlInternalTransaction.Dispose()
   at Microsoft.Data.SqlClient.SqlTransaction.Dispose(Boolean disposing)
   at System.Data.Common.DbTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalTransaction.DisposeAsync()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.ResetStateAsync(Boolean disposeDbConnection)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|26_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.EntityFrameworkCore.DbContext.DisposeAsync()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.<DisposeAsync>g__Await|26_0(Int32 i, ValueTask vt, List`1 toDispose)
   at Microsoft.AspNetCore.Http.Features.RequestServicesFeature.<DisposeAsync>g__Awaited|9_0(RequestServicesFeature servicesFeature, ValueTask vt)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.<FireOnCompleted>g__ProcessEvents|242_0(HttpProtocol protocol, Stack`1 events)
2025-01-12 17:13:09.600 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Int32), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p18='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0, [TotalPurchasePrice] = @p1, [TotalSalesPrice] = @p2
OUTPUT 1
WHERE [Id] = @p3;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-01-12 17:13:09.607 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 288.5602ms
2025-01-12 17:13:11.157 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:13:11.162 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:13:11.163 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:13:11.178 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:13:11.191 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:13:11.191 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:13:11.236 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Int32), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p18='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0, [TotalPurchasePrice] = @p1, [TotalSalesPrice] = @p2
OUTPUT 1
WHERE [Id] = @p3;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-01-12 17:13:11.271 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 104.8101ms
2025-01-12 17:13:11.274 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:13:11.371 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:13:11.387 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 230.054ms
2025-01-12 17:15:34.538 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 17:15:36.048 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.051 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.053 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.055 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.056 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.058 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.059 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.061 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.064 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.066 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.068 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.070 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.072 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.074 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.077 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.079 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.082 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:36.083 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:15:37.719 +03:00 [INF] Now listening on: https://localhost:7195
2025-01-12 17:15:37.720 +03:00 [INF] Now listening on: http://localhost:5285
2025-01-12 17:15:37.727 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 17:15:37.729 +03:00 [INF] Hosting environment: Development
2025-01-12 17:15:37.730 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 17:15:37.746 +03:00 [INF] Executed DbCommand (120ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:15:37.925 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:15:38.705 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/index.html - null null
2025-01-12 17:15:39.257 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/index.html - 200 null text/html;charset=utf-8 563.9921ms
2025-01-12 17:15:39.451 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_vs/browserLink - null null
2025-01-12 17:15:39.451 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 17:15:39.532 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 81.0437ms
2025-01-12 17:15:39.611 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_vs/browserLink - 200 null text/javascript; charset=UTF-8 160.8013ms
2025-01-12 17:15:39.711 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - null null
2025-01-12 17:15:40.121 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 416.4279ms
2025-01-12 17:16:01.786 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:16:02.115 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:16:02.155 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:16:02.645 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:16:02.948 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:16:03.183 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:16:03.365 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Guid), @p7='?' (Size = 4000), @p8='?' (DbType = Boolean), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Size = 4000), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-01-12 17:16:03.468 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0, [TotalPurchasePrice] = @p1, [TotalSalesPrice] = @p2
OUTPUT 1
WHERE [Id] = @p3;
INSERT INTO [OrderItems] ([OrderId], [ProductId], [Quantity], [UnitPrice])
OUTPUT INSERTED.[Id]
VALUES (@p4, @p5, @p6, @p7);
2025-01-12 17:16:03.533 +03:00 [INF] Executing OkObjectResult, writing value of type 'TagerProject.Models.Dtos.Order.OrderResponse'.
2025-01-12 17:16:03.585 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 1418.9046ms
2025-01-12 17:16:03.590 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:16:03.602 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 1815.7972ms
2025-01-12 17:16:10.248 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:16:10.261 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:16:10.263 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:16:10.423 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:16:10.450 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'TagerProject.Data.ApplicationDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-12 17:16:10.452 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000), @__productId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[ExpectedRevenue], [i].[MembershipNumber], [i].[ProductId], [i].[PurchaseUnitPrice], [i].[Quantity], [i].[SalesUnitPrice], [i].[TotalPurchasePrice], [i].[TotalSalesPrice], [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Inventories] AS [i]
INNER JOIN [Products] AS [p] ON [i].[ProductId] = [p].[Id]
WHERE [i].[MembershipNumber] = @__membershipNumber_0 AND [i].[ProductId] = @__productId_1
2025-01-12 17:16:10.570 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 300.3444ms
2025-01-12 17:16:10.575 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:16:10.674 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Int32), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Guid), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (DbType = Int32), @p15='?' (DbType = Int32), @p16='?' (Size = 4000), @p17='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p18='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Inventories] SET [Quantity] = @p0, [TotalPurchasePrice] = @p1, [TotalSalesPrice] = @p2
OUTPUT 1
WHERE [Id] = @p3;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-01-12 17:16:10.681 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at TagerProject.Services.OrderService.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Services\OrderService.cs:line 100
   at TagerProject.Controllers.OrdersController.InitiateOrder(OrderAddRequest orderAddRequest) in C:\aspnetcore\TagerProject\TagerProject\Controllers\OrdersController.cs:line 48
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at TagerProject.Middleware.UnauthorizedResponseMiddleware.InvokeAsync(HttpContext context) in C:\aspnetcore\TagerProject\TagerProject\Middleware\UnauthorizedResponseMiddleware.cs:line 17
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-01-12 17:16:10.732 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 500 null text/plain; charset=utf-8 483.7214ms
2025-01-12 17:16:38.004 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:16:38.016 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:17:38.062 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:17:38.071 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:17:57.127 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:17:57.189 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject)'
2025-01-12 17:17:57.211 +03:00 [INF] Route matched with {action = "GetAllOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOrders() on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:17:57.365 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__membershipNumber_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CouponCode], [o].[CustomerId], [o].[DateTime], [o].[DiscountAmount], [o].[DiscountId], [o].[FinalAmount], [o].[Guid], [o].[MembershipNumber], [o].[Paid], [o].[PaidAmount], [o].[PaymentMethodId], [o].[PaymentTypeId], [o].[Status], [o].[TaxAmount], [o].[TotalAmount], [o0].[Id], [o0].[OrderId], [o0].[ProductId], [o0].[Quantity], [o0].[UnitPrice]
FROM [Orders] AS [o]
LEFT JOIN [OrderItems] AS [o0] ON [o].[Id] = [o0].[OrderId]
WHERE [o].[MembershipNumber] = @__membershipNumber_0
ORDER BY [o].[Id]
2025-01-12 17:17:57.424 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[TagerProject.Models.Dtos.Order.OrderResponse, TagerProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-12 17:17:57.431 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject) in 200.3953ms
2025-01-12 17:17:57.433 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.GetAllOrders (TagerProject)'
2025-01-12 17:17:57.436 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 308.7603ms
2025-01-12 17:18:38.459 +03:00 [INF] User profile is available. Using 'C:\Users\pc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-12 17:18:40.047 +03:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Expense'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.052 +03:00 [WRN] No store type was specified for the decimal property 'ExpectedRevenue' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.055 +03:00 [WRN] No store type was specified for the decimal property 'PurchaseUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.056 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.058 +03:00 [WRN] No store type was specified for the decimal property 'TotalPurchasePrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.059 +03:00 [WRN] No store type was specified for the decimal property 'TotalSalesPrice' on entity type 'Inventory'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.061 +03:00 [WRN] No store type was specified for the decimal property 'DiscountAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.063 +03:00 [WRN] No store type was specified for the decimal property 'FinalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.065 +03:00 [WRN] No store type was specified for the decimal property 'PaidAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.067 +03:00 [WRN] No store type was specified for the decimal property 'TaxAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.069 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.070 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.072 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Package'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.073 +03:00 [WRN] No store type was specified for the decimal property 'Price' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.075 +03:00 [WRN] No store type was specified for the decimal property 'PriceIncludeTax' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.076 +03:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Purchase'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.078 +03:00 [WRN] No store type was specified for the decimal property 'SalesUnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:40.080 +03:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'PurchaseItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-12 17:18:41.424 +03:00 [INF] Now listening on: https://localhost:7195
2025-01-12 17:18:41.426 +03:00 [INF] Now listening on: http://localhost:5285
2025-01-12 17:18:41.433 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-12 17:18:41.434 +03:00 [INF] Hosting environment: Development
2025-01-12 17:18:41.436 +03:00 [INF] Content root path: C:\aspnetcore\TagerProject\TagerProject
2025-01-12 17:18:41.467 +03:00 [INF] Executed DbCommand (97ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:18:41.700 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:18:42.209 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/index.html - null null
2025-01-12 17:18:42.727 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/index.html - 200 null text/html;charset=utf-8 534.7668ms
2025-01-12 17:18:42.742 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - null null
2025-01-12 17:18:42.777 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/_vs/browserLink - null null
2025-01-12 17:18:42.821 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_framework/aspnetcore-browser-refresh.js - 200 13760 application/javascript; charset=utf-8 79.331ms
2025-01-12 17:18:42.938 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/_vs/browserLink - 200 null text/javascript; charset=UTF-8 161.1964ms
2025-01-12 17:18:43.005 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - null null
2025-01-12 17:18:43.311 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7195/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 306.3005ms
2025-01-12 17:19:41.795 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:19:41.806 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:20:41.919 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:20:41.927 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:21:41.961 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:21:41.970 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:22:42.001 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:22:42.011 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:23:42.037 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:23:42.048 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:29:58.807 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:29:58.814 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:30:58.832 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:30:58.843 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:31:58.880 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:31:58.889 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:32:58.942 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:32:58.950 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:33:58.970 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:33:58.980 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:34:59.016 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:34:59.025 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:35:59.056 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:35:59.066 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:36:59.103 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:36:59.118 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:37:59.153 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:37:59.161 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:38:59.201 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:38:59.212 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:40:17.057 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:40:17.272 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:40:17.307 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:40:17.587 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:40:17.816 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Guid), @p7='?' (Size = 4000), @p8='?' (DbType = Boolean), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Size = 4000), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-01-12 17:40:17.878 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([OrderId], [ProductId], [Quantity], [UnitPrice])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-01-12 17:40:17.901 +03:00 [INF] Executing OkObjectResult, writing value of type 'TagerProject.Models.Dtos.Order.OrderResponse'.
2025-01-12 17:40:17.930 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 616.2138ms
2025-01-12 17:40:17.932 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:40:17.937 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 879.5177ms
2025-01-12 17:40:19.435 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:40:19.443 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:40:19.445 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:40:19.454 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:40:19.460 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Guid), @p7='?' (Size = 4000), @p8='?' (DbType = Boolean), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Size = 4000), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-01-12 17:40:19.463 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([OrderId], [ProductId], [Quantity], [UnitPrice])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-01-12 17:40:19.467 +03:00 [INF] Executing OkObjectResult, writing value of type 'TagerProject.Models.Dtos.Order.OrderResponse'.
2025-01-12 17:40:19.469 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 22.5262ms
2025-01-12 17:40:19.470 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:40:19.471 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 36.68ms
2025-01-12 17:40:20.763 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:40:20.768 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:40:20.769 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:40:20.777 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:40:20.782 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Guid), @p7='?' (Size = 4000), @p8='?' (DbType = Boolean), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Size = 4000), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-01-12 17:40:20.787 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([OrderId], [ProductId], [Quantity], [UnitPrice])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-01-12 17:40:20.790 +03:00 [INF] Executing OkObjectResult, writing value of type 'TagerProject.Models.Dtos.Order.OrderResponse'.
2025-01-12 17:40:20.791 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 19.2816ms
2025-01-12 17:40:20.793 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:40:20.794 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 30.6942ms
2025-01-12 17:40:21.874 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7195/api/v1/orders - application/json 195
2025-01-12 17:40:21.879 +03:00 [INF] Executing endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:40:21.880 +03:00 [INF] Route matched with {action = "InitiateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] InitiateOrder(TagerProject.Models.Dtos.Order.OrderAddRequest) on controller TagerProject.Controllers.OrdersController (TagerProject).
2025-01-12 17:40:21.885 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[BrandId], [p].[CategoryId], [p].[Description], [p].[ImageUrl], [p].[IsActive], [p].[IsDeleted], [p].[MembershipNumber], [p].[NameAr], [p].[NameEn], [p].[Price], [p].[PriceIncludeTax], [p].[TaxId], [p].[UnitId]
FROM [Products] AS [p]
WHERE [p].[Id] IN (
    SELECT [p0].[value]
    FROM OPENJSON(@__productIds_0) WITH ([value] int '$') AS [p0]
)
2025-01-12 17:40:21.891 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Guid), @p7='?' (Size = 4000), @p8='?' (DbType = Boolean), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Size = 4000), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CouponCode], [CustomerId], [DateTime], [DiscountAmount], [DiscountId], [FinalAmount], [Guid], [MembershipNumber], [Paid], [PaidAmount], [PaymentMethodId], [PaymentTypeId], [Status], [TaxAmount], [TotalAmount])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2025-01-12 17:40:21.896 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([OrderId], [ProductId], [Quantity], [UnitPrice])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-01-12 17:40:21.898 +03:00 [INF] Executing OkObjectResult, writing value of type 'TagerProject.Models.Dtos.Order.OrderResponse'.
2025-01-12 17:40:21.901 +03:00 [INF] Executed action TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject) in 19.0485ms
2025-01-12 17:40:21.902 +03:00 [INF] Executed endpoint 'TagerProject.Controllers.OrdersController.InitiateOrder (TagerProject)'
2025-01-12 17:40:21.903 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7195/api/v1/orders - 200 null application/json; charset=utf-8 28.901ms
2025-01-12 17:40:50.886 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:40:50.898 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:41:50.928 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:41:50.939 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:42:50.997 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:42:51.016 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:43:51.046 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:43:51.054 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:44:51.084 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:44:51.093 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:45:51.127 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:45:51.136 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:46:51.162 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:46:51.173 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:47:51.233 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:47:51.248 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:48:51.274 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:48:51.282 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:49:51.307 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:49:51.315 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:50:51.348 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:50:51.355 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:51:51.381 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:51:51.391 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:52:51.411 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:52:51.422 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:53:51.445 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:53:51.454 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:54:51.472 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:54:51.481 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:55:51.507 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:55:51.515 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:56:51.536 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:56:51.543 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:57:51.572 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:57:51.592 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:58:51.614 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:58:51.625 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 17:59:51.642 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 17:59:51.650 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 18:00:51.680 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 18:00:51.690 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 18:01:51.719 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 18:01:51.730 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 18:02:51.765 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 18:02:51.778 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 18:03:51.802 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 18:03:51.812 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 18:14:31.122 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 18:14:31.127 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 18:15:31.150 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 18:15:31.171 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 18:16:31.207 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 18:16:31.219 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
2025-01-12 18:17:31.256 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__now_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[EndDate], [s].[PackageId], [s].[StartDate]
FROM [Subscriptions] AS [s]
WHERE [s].[EndDate] <= @__now_0
2025-01-12 18:17:31.268 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__expiredSubscription_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[Address], [o].[BusinessName], [o].[CityId], [o].[CommercialRegister], [o].[Email], [o].[FirstName], [o].[IsActive], [o].[IsDeleted], [o].[LastName], [o].[MembershipNumber], [o].[Password], [o].[PhoneNumber], [o].[SubscriptionId], [o].[TIN]
FROM [Owners] AS [o]
WHERE [o].[SubscriptionId] = @__expiredSubscription_Id_0 AND [o].[IsActive] = CAST(1 AS bit)
